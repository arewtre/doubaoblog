<div class="article-content border">
   <div id="content"> 
    <p><strong>前言：</strong></p> 
    <p>PHP实现QQ快速登录，罗列了三种方法</p> 
    <p><span style="color: #800000"><strong>方法一：</strong></span>面向过程，回调地址和首次触发登录写到了一个方法页面【因为有了if做判断】，</p> 
    <p><span style="color: #800000"><strong>方法二，三：</strong></span>面向对象<br /> </p> 
    <p>1.先调用登录方法，向腾讯发送请求，<br /> 2.腾讯携带本网站唯一对应参数OPENID,ACCESSTOKEN，返回到对应回调页面，<br /> 3.回调页面接受到腾讯的参数后，通过这个两个参数，再发出对应的请求，如查询用户的数据。<br /> 4.腾讯做出对应的操作，如返回这个用户的数据给你<br /> </p> 
    <p>即使你没看懂，也没关系，按照我下面的流程来，保证你可以实现。<br /> </p> 
    <p><strong>前期准备：</strong></p> 
    <p>使用人家腾讯的功能，总得和人家打招呼吧！</p> 
    <p>QQ互联首页：http://connect.qq.com/</p> 
    <p>进入网址后，按如下操作来：</p> 
    <p><strong>一.进入官网</strong></p> 
    <p style="text-align: center"><a href="https://files.jb51.net/file_images/article/201609/2016928162720599.jpg?2016828162728" target="_blank" class="bPic"><img id="theimg" alt="" src="//files.jb51.net/file_images/article/201609/2016928162720599.jpg?2016828162728" style="width: 650px; height: auto;" /></a><br /> </p> 
    <p><strong>二.申请创建【网站】应用</strong></p> 
    <p style="text-align: center"><a href="https://files.jb51.net/file_images/article/201609/2016092816250110.png" target="_blank" class="bPic"><img alt="" src="//files.jb51.net/file_images/article/201609/2016092816250110.png" style="width: 650px; height: auto;" /></a><br /> </p> 
    <p><strong>三.按要求填写资料</strong></p> 
    <p>注意网站地址：填写你要设置快速登录的网址，eg:http://www.test.com; &nbsp;</p> 
    <p>回调地址:填写你发送QQ快速登陆后，腾讯得给你信息，这个信息往此页面接受。eg:http://www.test.com/accept_info.php</p> 
    <p><strong>【详细的申请填写，请见官方提示，这里不做赘述】</strong></p> 
    <p style="text-align: center"><img alt="" src="//files.jb51.net/file_images/article/201609/2016092816250211.png" /><br /> </p> 
    <p><strong>四.申请成功后，完善信息</strong></p> 
    <p style="text-align: center"><a href="https://files.jb51.net/file_images/article/201609/2016092816250212.png" target="_blank" class="bPic"><img alt="" src="//files.jb51.net/file_images/article/201609/2016092816250212.png" style="width: 650px; height: auto;" /></a></p> 
    <p><strong>最终要求，获得APP_ID ，APP_KEY</strong></p> 
    <p><strong>五.代码部分：</strong></p> 
    <p>在你对应的PHP文件内写入，如下<br /> <span style="color: #800000"><strong>方法一，</strong></span>面向过程法<br /> 使用方法：配置$app_id，$app_secret，$my_url后，其他原封复制即可，$user_data为返回的登录信息<br /> 代码：<br /> </p> 
    <div class="jb51code"> 
     <div>
      <div id="highlighter_706773" class="syntaxhighlighter  php">
       <div class="toolbar">
        <span><a href="#" class="toolbar_item command_help help">?</a></span>
       </div>
       <table border="0" cellpadding="0" cellspacing="0">
        <tbody>
         <tr>
          <td class="gutter">
           <div class="line number1 index0 alt2">
            1
           </div>
           <div class="line number2 index1 alt1">
            2
           </div>
           <div class="line number3 index2 alt2">
            3
           </div>
           <div class="line number4 index3 alt1">
            4
           </div>
           <div class="line number5 index4 alt2">
            5
           </div>
           <div class="line number6 index5 alt1">
            6
           </div>
           <div class="line number7 index6 alt2">
            7
           </div>
           <div class="line number8 index7 alt1">
            8
           </div>
           <div class="line number9 index8 alt2">
            9
           </div>
           <div class="line number10 index9 alt1">
            10
           </div>
           <div class="line number11 index10 alt2">
            11
           </div>
           <div class="line number12 index11 alt1">
            12
           </div>
           <div class="line number13 index12 alt2">
            13
           </div>
           <div class="line number14 index13 alt1">
            14
           </div>
           <div class="line number15 index14 alt2">
            15
           </div>
           <div class="line number16 index15 alt1">
            16
           </div>
           <div class="line number17 index16 alt2">
            17
           </div>
           <div class="line number18 index17 alt1">
            18
           </div>
           <div class="line number19 index18 alt2">
            19
           </div>
           <div class="line number20 index19 alt1">
            20
           </div>
           <div class="line number21 index20 alt2">
            21
           </div>
           <div class="line number22 index21 alt1">
            22
           </div>
           <div class="line number23 index22 alt2">
            23
           </div>
           <div class="line number24 index23 alt1">
            24
           </div>
           <div class="line number25 index24 alt2">
            25
           </div>
           <div class="line number26 index25 alt1">
            26
           </div>
           <div class="line number27 index26 alt2">
            27
           </div>
           <div class="line number28 index27 alt1">
            28
           </div>
           <div class="line number29 index28 alt2">
            29
           </div>
           <div class="line number30 index29 alt1">
            30
           </div>
           <div class="line number31 index30 alt2">
            31
           </div>
           <div class="line number32 index31 alt1">
            32
           </div>
           <div class="line number33 index32 alt2">
            33
           </div>
           <div class="line number34 index33 alt1">
            34
           </div>
           <div class="line number35 index34 alt2">
            35
           </div>
           <div class="line number36 index35 alt1">
            36
           </div>
           <div class="line number37 index36 alt2">
            37
           </div>
           <div class="line number38 index37 alt1">
            38
           </div>
           <div class="line number39 index38 alt2">
            39
           </div>
           <div class="line number40 index39 alt1">
            40
           </div>
           <div class="line number41 index40 alt2">
            41
           </div>
           <div class="line number42 index41 alt1">
            42
           </div>
           <div class="line number43 index42 alt2">
            43
           </div>
           <div class="line number44 index43 alt1">
            44
           </div>
           <div class="line number45 index44 alt2">
            45
           </div>
           <div class="line number46 index45 alt1">
            46
           </div>
           <div class="line number47 index46 alt2">
            47
           </div>
           <div class="line number48 index47 alt1">
            48
           </div>
           <div class="line number49 index48 alt2">
            49
           </div>
           <div class="line number50 index49 alt1">
            50
           </div>
           <div class="line number51 index50 alt2">
            51
           </div>
           <div class="line number52 index51 alt1">
            52
           </div>
           <div class="line number53 index52 alt2">
            53
           </div>
           <div class="line number54 index53 alt1">
            54
           </div>
           <div class="line number55 index54 alt2">
            55
           </div>
           <div class="line number56 index55 alt1">
            56
           </div>
           <div class="line number57 index56 alt2">
            57
           </div>
           <div class="line number58 index57 alt1">
            58
           </div>
           <div class="line number59 index58 alt2">
            59
           </div>
           <div class="line number60 index59 alt1">
            60
           </div>
           <div class="line number61 index60 alt2">
            61
           </div>
           <div class="line number62 index61 alt1">
            62
           </div>
           <div class="line number63 index62 alt2">
            63
           </div>
           <div class="line number64 index63 alt1">
            64
           </div>
           <div class="line number65 index64 alt2">
            65
           </div>
           <div class="line number66 index65 alt1">
            66
           </div>
           <div class="line number67 index66 alt2">
            67
           </div>
           <div class="line number68 index67 alt1">
            68
           </div>
           <div class="line number69 index68 alt2">
            69
           </div>
           <div class="line number70 index69 alt1">
            70
           </div>
           <div class="line number71 index70 alt2">
            71
           </div>
           <div class="line number72 index71 alt1">
            72
           </div>
           <div class="line number73 index72 alt2">
            73
           </div></td>
          <td class="code">
           <div class="container">
            <div class="line number1 index0 alt2">
             <code class="php comments">//应用的APPID </code>
            </div>
            <div class="line number2 index1 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$app_id</code> 
             <code class="php plain">= </code>
             <code class="php string">&quot;你的APPID&quot;</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number3 index2 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php comments">//应用的APPKEY </code>
            </div>
            <div class="line number4 index3 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$app_secret</code> 
             <code class="php plain">= </code>
             <code class="php string">&quot;你的APPKEY&quot;</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number5 index4 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php comments">//【成功授权】后的回调地址，即此地址在腾讯的信息中有储存 </code>
            </div>
            <div class="line number6 index5 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$my_url</code> 
             <code class="php plain">= </code>
             <code class="php string">&quot;你的回调网址&quot;</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number7 index6 alt2">
             <code class="php spaces">&nbsp;</code>&nbsp;
            </div>
            <div class="line number8 index7 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php comments">//Step1：获取Authorization Code </code>
            </div>
            <div class="line number9 index8 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">session_start(); </code>
            </div>
            <div class="line number10 index9 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$code</code> 
             <code class="php plain">= </code>
             <code class="php variable">$_REQUEST</code>
             <code class="php plain">[</code>
             <code class="php string">&quot;code&quot;</code>
             <code class="php plain">];</code>
             <code class="php comments">//存放Authorization Code </code>
            </div>
            <div class="line number11 index10 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(</code>
             <code class="php functions">empty</code>
             <code class="php plain">(</code>
             <code class="php variable">$code</code>
             <code class="php plain">)) </code>
            </div>
            <div class="line number12 index11 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">{ </code>
            </div>
            <div class="line number13 index12 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php comments">//state参数用于防止CSRF攻击，成功授权后回调时会原样带回 </code>
            </div>
            <div class="line number14 index13 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$_SESSION</code>
             <code class="php plain">[</code>
             <code class="php string">'state'</code>
             <code class="php plain">] = md5(uniqid(rand(), TRUE)); </code>
            </div>
            <div class="line number15 index14 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php comments">//拼接URL </code>
            </div>
            <div class="line number16 index15 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$dialog_url</code> 
             <code class="php plain">= </code>
             <code class="php string">&quot;<a href="https://graph.qq.com/oauth2.0/authorize?response_type=code&amp;client_id=">https://graph.qq.com/oauth2.0/authorize?response_type=code&amp;client_id=</a>&quot;</code>
            </div>
            <div class="line number17 index16 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">. </code>
             <code class="php variable">$app_id</code> 
             <code class="php plain">. </code>
             <code class="php string">&quot;&amp;redirect_uri=&quot;</code> 
             <code class="php plain">. urlencode(</code>
             <code class="php variable">$my_url</code>
             <code class="php plain">) . </code>
             <code class="php string">&quot;&amp;state=&quot;</code>
            </div>
            <div class="line number18 index17 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">. </code>
             <code class="php variable">$_SESSION</code>
             <code class="php plain">[</code>
             <code class="php string">'state'</code>
             <code class="php plain">]; </code>
            </div>
            <div class="line number19 index18 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php functions">echo</code>
             <code class="php plain">(</code>
             <code class="php string">&quot;&lt;script&gt; top.location.href='&quot;</code> 
             <code class="php plain">. </code>
             <code class="php variable">$dialog_url</code> 
             <code class="php plain">. </code>
             <code class="php string">&quot;'&lt;/script&gt;&quot;</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number20 index19 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number21 index20 alt2">
             <code class="php spaces">&nbsp;</code>&nbsp;
            </div>
            <div class="line number22 index21 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php comments">//Step2：通过Authorization Code获取Access Token </code>
            </div>
            <div class="line number23 index22 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(</code>
             <code class="php variable">$_REQUEST</code>
             <code class="php plain">[</code>
             <code class="php string">'state'</code>
             <code class="php plain">] == </code>
             <code class="php variable">$_SESSION</code>
             <code class="php plain">[</code>
             <code class="php string">'state'</code>
             <code class="php plain">] || 1) </code>
            </div>
            <div class="line number24 index23 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">{ </code>
            </div>
            <div class="line number25 index24 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php comments">//拼接URL </code>
            </div>
            <div class="line number26 index25 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$token_url</code> 
             <code class="php plain">= </code>
             <code class="php string">&quot;<a href="https://graph.qq.com/oauth2.0/token?grant_type=authorization_code&amp;">https://graph.qq.com/oauth2.0/token?grant_type=authorization_code&amp;</a>&quot;</code>
            </div>
            <div class="line number27 index26 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">. </code>
             <code class="php string">&quot;client_id=&quot;</code> 
             <code class="php plain">. </code>
             <code class="php variable">$app_id</code> 
             <code class="php plain">. </code>
             <code class="php string">&quot;&amp;redirect_uri=&quot;</code> 
             <code class="php plain">. urlencode(</code>
             <code class="php variable">$my_url</code>
             <code class="php plain">) </code>
            </div>
            <div class="line number28 index27 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">. </code>
             <code class="php string">&quot;&amp;client_secret=&quot;</code> 
             <code class="php plain">. </code>
             <code class="php variable">$app_secret</code> 
             <code class="php plain">. </code>
             <code class="php string">&quot;&amp;code=&quot;</code> 
             <code class="php plain">. </code>
             <code class="php variable">$code</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number29 index28 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$response</code> 
             <code class="php plain">= </code>
             <code class="php functions">file_get_contents</code>
             <code class="php plain">(</code>
             <code class="php variable">$token_url</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number30 index29 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">if</code> 
             <code class="php plain">(</code>
             <code class="php functions">strpos</code>
             <code class="php plain">(</code>
             <code class="php variable">$response</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;callback&quot;</code>
             <code class="php plain">) !== false)</code>
             <code class="php comments">//如果登录用户临时改变主意取消了，返回true!==false,否则执行step3 </code>
            </div>
            <div class="line number31 index30 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">{ </code>
            </div>
            <div class="line number32 index31 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$lpos</code> 
             <code class="php plain">= </code>
             <code class="php functions">strpos</code>
             <code class="php plain">(</code>
             <code class="php variable">$response</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;(&quot;</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number33 index32 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$rpos</code> 
             <code class="php plain">= </code>
             <code class="php functions">strrpos</code>
             <code class="php plain">(</code>
             <code class="php variable">$response</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;)&quot;</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number34 index33 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$response</code> 
             <code class="php plain">= </code>
             <code class="php functions">substr</code>
             <code class="php plain">(</code>
             <code class="php variable">$response</code>
             <code class="php plain">, </code>
             <code class="php variable">$lpos</code> 
             <code class="php plain">+ 1, </code>
             <code class="php variable">$rpos</code> 
             <code class="php plain">- </code>
             <code class="php variable">$lpos</code> 
             <code class="php plain">-1); </code>
            </div>
            <div class="line number35 index34 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$msg</code> 
             <code class="php plain">= json_decode(</code>
             <code class="php variable">$response</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number36 index35 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">if</code> 
             <code class="php plain">(isset(</code>
             <code class="php variable">$msg</code>
             <code class="php plain">-&gt;error)) </code>
            </div>
            <div class="line number37 index36 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">{ </code>
            </div>
            <div class="line number38 index37 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php functions">echo</code> 
             <code class="php string">&quot;&lt;h3&gt;error:&lt;/h3&gt;&quot;</code> 
             <code class="php plain">. </code>
             <code class="php variable">$msg</code>
             <code class="php plain">-&gt;error; </code>
            </div>
            <div class="line number39 index38 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php functions">echo</code> 
             <code class="php string">&quot;&lt;h3&gt;msg :&lt;/h3&gt;&quot;</code> 
             <code class="php plain">. </code>
             <code class="php variable">$msg</code>
             <code class="php plain">-&gt;error_description; </code>
            </div>
            <div class="line number40 index39 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php functions">exit</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number41 index40 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number42 index41 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number43 index42 alt2">
             <code class="php spaces">&nbsp;</code>&nbsp;
            </div>
            <div class="line number44 index43 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php comments">//Step3：使用Access Token来获取用户的OpenID </code>
            </div>
            <div class="line number45 index44 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$params</code> 
             <code class="php plain">= </code>
             <code class="php keyword">array</code>
             <code class="php plain">(); </code>
            </div>
            <div class="line number46 index45 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php functions">parse_str</code>
             <code class="php plain">(</code>
             <code class="php variable">$response</code>
             <code class="php plain">, </code>
             <code class="php variable">$params</code>
             <code class="php plain">);</code>
             <code class="php comments">//把传回来的数据参数变量化 </code>
            </div>
            <div class="line number47 index46 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$graph_url</code> 
             <code class="php plain">= </code>
             <code class="php string">&quot;<a href="https://graph.qq.com/oauth2.0/me?access_token=">https://graph.qq.com/oauth2.0/me?access_token=</a>&quot;</code>
             <code class="php plain">.</code>
             <code class="php variable">$params</code>
             <code class="php plain">[</code>
             <code class="php string">'access_token'</code>
             <code class="php plain">]; </code>
            </div>
            <div class="line number48 index47 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$str</code> 
             <code class="php plain">= </code>
             <code class="php functions">file_get_contents</code>
             <code class="php plain">(</code>
             <code class="php variable">$graph_url</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number49 index48 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">if</code> 
             <code class="php plain">(</code>
             <code class="php functions">strpos</code>
             <code class="php plain">(</code>
             <code class="php variable">$str</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;callback&quot;</code>
             <code class="php plain">) !== false) </code>
            </div>
            <div class="line number50 index49 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">{ </code>
            </div>
            <div class="line number51 index50 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$lpos</code> 
             <code class="php plain">= </code>
             <code class="php functions">strpos</code>
             <code class="php plain">(</code>
             <code class="php variable">$str</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;(&quot;</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number52 index51 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$rpos</code> 
             <code class="php plain">= </code>
             <code class="php functions">strrpos</code>
             <code class="php plain">(</code>
             <code class="php variable">$str</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;)&quot;</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number53 index52 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$str</code> 
             <code class="php plain">= </code>
             <code class="php functions">substr</code>
             <code class="php plain">(</code>
             <code class="php variable">$str</code>
             <code class="php plain">, </code>
             <code class="php variable">$lpos</code> 
             <code class="php plain">+ 1, </code>
             <code class="php variable">$rpos</code> 
             <code class="php plain">- </code>
             <code class="php variable">$lpos</code> 
             <code class="php plain">-1); </code>
            </div>
            <div class="line number54 index53 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number55 index54 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$user</code> 
             <code class="php plain">= json_decode(</code>
             <code class="php variable">$str</code>
             <code class="php plain">);</code>
             <code class="php comments">//存放返回的数据 client_id ，openid </code>
            </div>
            <div class="line number56 index55 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">if</code> 
             <code class="php plain">(isset(</code>
             <code class="php variable">$user</code>
             <code class="php plain">-&gt;error)) </code>
            </div>
            <div class="line number57 index56 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">{ </code>
            </div>
            <div class="line number58 index57 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php functions">echo</code> 
             <code class="php string">&quot;&lt;h3&gt;error:&lt;/h3&gt;&quot;</code> 
             <code class="php plain">. </code>
             <code class="php variable">$user</code>
             <code class="php plain">-&gt;error; </code>
            </div>
            <div class="line number59 index58 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php functions">echo</code> 
             <code class="php string">&quot;&lt;h3&gt;msg :&lt;/h3&gt;&quot;</code> 
             <code class="php plain">. </code>
             <code class="php variable">$user</code>
             <code class="php plain">-&gt;error_description; </code>
            </div>
            <div class="line number60 index59 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php functions">exit</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number61 index60 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number62 index61 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php comments">//echo(&quot;Hello &quot; . $user-&gt;openid); </code>
            </div>
            <div class="line number63 index62 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php comments">//echo(&quot;Hello &quot; . $params['access_token']); </code>
            </div>
            <div class="line number64 index63 alt1">
             <code class="php spaces">&nbsp;</code>&nbsp;
            </div>
            <div class="line number65 index64 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php comments">//Step4：使用&lt;span style=&quot;font-family: Arial, Helvetica, sans-serif;&quot;&gt;openid,&lt;/span&gt;&lt;span style=&quot;font-family: Arial, Helvetica, sans-serif;&quot;&gt;access_token来获取所接受的用户信息。&lt;/span&gt; </code>
            </div>
            <div class="line number66 index65 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$user_data_url</code> 
             <code class="php plain">= </code>
             <code class="php string">&quot;<a href="https://graph.qq.com/user/get_user_info?access_token=">https://graph.qq.com/user/get_user_info?access_token=</a>{$params['access_token']}&amp;oauth_consumer_key={$app_id}&amp;openid={$user-&gt;openid}&amp;format=json&quot;</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number67 index66 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;
            </div>
            <div class="line number68 index67 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$user_data</code> 
             <code class="php plain">= </code>
             <code class="php functions">file_get_contents</code>
             <code class="php plain">(</code>
             <code class="php variable">$user_data_url</code>
             <code class="php plain">);</code>
             <code class="php comments">//此为获取到的user信息 </code>
            </div>
            <div class="line number69 index68 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number70 index69 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">else</code>
            </div>
            <div class="line number71 index70 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">{ </code>
            </div>
            <div class="line number72 index71 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php functions">echo</code>
             <code class="php plain">(</code>
             <code class="php string">&quot;The state does not match. You may be a victim of CSRF.&quot;</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number73 index72 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
           </div></td>
         </tr>
        </tbody>
       </table>
      </div>
     </div> 
    </div> 
    <p><span style="color: #800000"><strong>方法二，</strong></span>面向对象 使用类QQ_LoginAction.class<br /> 使用方法：<br /> 1.在QQ_LoginAction.class中正确配置 APPID，APPKEY CALLBACK(回调网址)<br /> 2.在调用方法中，代码：<br /> </p> 
    <div class="jb51code"> 
     <div>
      <div id="highlighter_265497" class="syntaxhighlighter  php">
       <div class="toolbar">
        <span><a href="#" class="toolbar_item command_help help">?</a></span>
       </div>
       <table border="0" cellpadding="0" cellspacing="0">
        <tbody>
         <tr>
          <td class="gutter">
           <div class="line number1 index0 alt2">
            1
           </div>
           <div class="line number2 index1 alt1">
            2
           </div></td>
          <td class="code">
           <div class="container">
            <div class="line number1 index0 alt2">
             <code class="php variable">$qq_login</code> 
             <code class="php plain">= </code>
             <code class="php keyword">new</code> 
             <code class="php plain">\Component\QQ_LoginAction();&nbsp;&nbsp;&nbsp; </code>
             <code class="php comments">//引入此类文件即可 </code>
            </div>
            <div class="line number2 index1 alt1">
             <code class="php variable">$qq_login</code>
             <code class="php plain">-&gt;qq_login();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code>
             <code class="php comments">//调用登录方法，向腾讯发出快速登录请求 </code>
            </div>
           </div></td>
         </tr>
        </tbody>
       </table>
      </div>
     </div> 
    </div> 
    <p>3.在回调页面中，代码：<br /> </p> 
    <div class="jb51code"> 
     <div>
      <div id="highlighter_830845" class="syntaxhighlighter  php">
       <div class="toolbar">
        <span><a href="#" class="toolbar_item command_help help">?</a></span>
       </div>
       <table border="0" cellpadding="0" cellspacing="0">
        <tbody>
         <tr>
          <td class="gutter">
           <div class="line number1 index0 alt2">
            1
           </div>
           <div class="line number2 index1 alt1">
            2
           </div>
           <div class="line number3 index2 alt2">
            3
           </div>
           <div class="line number4 index3 alt1">
            4
           </div></td>
          <td class="code">
           <div class="container">
            <div class="line number1 index0 alt2">
             <code class="php variable">$qc</code> 
             <code class="php plain">= </code>
             <code class="php keyword">new</code> 
             <code class="php plain">\Component\QQ_LoginAction(); </code>
            </div>
            <div class="line number2 index1 alt1">
             <code class="php variable">$acs</code> 
             <code class="php plain">= </code>
             <code class="php variable">$qc</code>
             <code class="php plain">-&gt;qq_callback();&lt;span style=</code>
             <code class="php string">&quot;white-space:pre&quot;</code>
             <code class="php plain">&gt;&nbsp;&nbsp;&nbsp; </code>
             <code class="php comments">//access_token </code>
            </div>
            <div class="line number3 index2 alt2">
             <code class="php variable">$oid</code>
             <code class="php plain">=</code>
             <code class="php variable">$qc</code>
             <code class="php plain">-&gt;get_openid();&lt;span style=</code>
             <code class="php string">&quot;white-space:pre&quot;</code>
             <code class="php plain">&gt;&nbsp;&nbsp;&nbsp;&nbsp; </code>
             <code class="php comments">//openid </code>
            </div>
            <div class="line number4 index3 alt1">
             <code class="php variable">$user_data</code> 
             <code class="php plain">= </code>
             <code class="php variable">$qc</code>
             <code class="php plain">-&gt;get_user_info();&lt;span style=</code>
             <code class="php string">&quot;white-space:pre&quot;</code>
             <code class="php plain">&gt;&nbsp; </code>
             <code class="php comments">//get_user_info()为获得该用户的信息，其他操作方法见API文档 </code>
            </div>
           </div></td>
         </tr>
        </tbody>
       </table>
      </div>
     </div> 
    </div> 
    <p>4.$user_data即为返回的用户数据。<br /> 5.QQ_LoginAction.class.php 文件代码：【用的ThinkPHP3.2】<br /> </p> 
    <div class="jb51code"> 
     <div>
      <div id="highlighter_786802" class="syntaxhighlighter  php">
       <div class="toolbar">
        <span><a href="#" class="toolbar_item command_help help">?</a></span>
       </div>
       <table border="0" cellpadding="0" cellspacing="0">
        <tbody>
         <tr>
          <td class="gutter">
           <div class="line number1 index0 alt2">
            1
           </div>
           <div class="line number2 index1 alt1">
            2
           </div>
           <div class="line number3 index2 alt2">
            3
           </div>
           <div class="line number4 index3 alt1">
            4
           </div>
           <div class="line number5 index4 alt2">
            5
           </div>
           <div class="line number6 index5 alt1">
            6
           </div>
           <div class="line number7 index6 alt2">
            7
           </div>
           <div class="line number8 index7 alt1">
            8
           </div>
           <div class="line number9 index8 alt2">
            9
           </div>
           <div class="line number10 index9 alt1">
            10
           </div>
           <div class="line number11 index10 alt2">
            11
           </div>
           <div class="line number12 index11 alt1">
            12
           </div>
           <div class="line number13 index12 alt2">
            13
           </div>
           <div class="line number14 index13 alt1">
            14
           </div>
           <div class="line number15 index14 alt2">
            15
           </div>
           <div class="line number16 index15 alt1">
            16
           </div>
           <div class="line number17 index16 alt2">
            17
           </div>
           <div class="line number18 index17 alt1">
            18
           </div>
           <div class="line number19 index18 alt2">
            19
           </div>
           <div class="line number20 index19 alt1">
            20
           </div>
           <div class="line number21 index20 alt2">
            21
           </div>
           <div class="line number22 index21 alt1">
            22
           </div>
           <div class="line number23 index22 alt2">
            23
           </div>
           <div class="line number24 index23 alt1">
            24
           </div>
           <div class="line number25 index24 alt2">
            25
           </div>
           <div class="line number26 index25 alt1">
            26
           </div>
           <div class="line number27 index26 alt2">
            27
           </div>
           <div class="line number28 index27 alt1">
            28
           </div>
           <div class="line number29 index28 alt2">
            29
           </div>
           <div class="line number30 index29 alt1">
            30
           </div>
           <div class="line number31 index30 alt2">
            31
           </div>
           <div class="line number32 index31 alt1">
            32
           </div>
           <div class="line number33 index32 alt2">
            33
           </div>
           <div class="line number34 index33 alt1">
            34
           </div>
           <div class="line number35 index34 alt2">
            35
           </div>
           <div class="line number36 index35 alt1">
            36
           </div>
           <div class="line number37 index36 alt2">
            37
           </div>
           <div class="line number38 index37 alt1">
            38
           </div>
           <div class="line number39 index38 alt2">
            39
           </div>
           <div class="line number40 index39 alt1">
            40
           </div>
           <div class="line number41 index40 alt2">
            41
           </div>
           <div class="line number42 index41 alt1">
            42
           </div>
           <div class="line number43 index42 alt2">
            43
           </div>
           <div class="line number44 index43 alt1">
            44
           </div>
           <div class="line number45 index44 alt2">
            45
           </div>
           <div class="line number46 index45 alt1">
            46
           </div>
           <div class="line number47 index46 alt2">
            47
           </div>
           <div class="line number48 index47 alt1">
            48
           </div>
           <div class="line number49 index48 alt2">
            49
           </div>
           <div class="line number50 index49 alt1">
            50
           </div>
           <div class="line number51 index50 alt2">
            51
           </div>
           <div class="line number52 index51 alt1">
            52
           </div>
           <div class="line number53 index52 alt2">
            53
           </div>
           <div class="line number54 index53 alt1">
            54
           </div>
           <div class="line number55 index54 alt2">
            55
           </div>
           <div class="line number56 index55 alt1">
            56
           </div>
           <div class="line number57 index56 alt2">
            57
           </div>
           <div class="line number58 index57 alt1">
            58
           </div>
           <div class="line number59 index58 alt2">
            59
           </div>
           <div class="line number60 index59 alt1">
            60
           </div>
           <div class="line number61 index60 alt2">
            61
           </div>
           <div class="line number62 index61 alt1">
            62
           </div>
           <div class="line number63 index62 alt2">
            63
           </div>
           <div class="line number64 index63 alt1">
            64
           </div>
           <div class="line number65 index64 alt2">
            65
           </div>
           <div class="line number66 index65 alt1">
            66
           </div>
           <div class="line number67 index66 alt2">
            67
           </div>
           <div class="line number68 index67 alt1">
            68
           </div>
           <div class="line number69 index68 alt2">
            69
           </div>
           <div class="line number70 index69 alt1">
            70
           </div>
           <div class="line number71 index70 alt2">
            71
           </div>
           <div class="line number72 index71 alt1">
            72
           </div>
           <div class="line number73 index72 alt2">
            73
           </div>
           <div class="line number74 index73 alt1">
            74
           </div>
           <div class="line number75 index74 alt2">
            75
           </div>
           <div class="line number76 index75 alt1">
            76
           </div>
           <div class="line number77 index76 alt2">
            77
           </div>
           <div class="line number78 index77 alt1">
            78
           </div>
           <div class="line number79 index78 alt2">
            79
           </div>
           <div class="line number80 index79 alt1">
            80
           </div>
           <div class="line number81 index80 alt2">
            81
           </div>
           <div class="line number82 index81 alt1">
            82
           </div>
           <div class="line number83 index82 alt2">
            83
           </div>
           <div class="line number84 index83 alt1">
            84
           </div>
           <div class="line number85 index84 alt2">
            85
           </div>
           <div class="line number86 index85 alt1">
            86
           </div>
           <div class="line number87 index86 alt2">
            87
           </div>
           <div class="line number88 index87 alt1">
            88
           </div>
           <div class="line number89 index88 alt2">
            89
           </div>
           <div class="line number90 index89 alt1">
            90
           </div>
           <div class="line number91 index90 alt2">
            91
           </div>
           <div class="line number92 index91 alt1">
            92
           </div>
           <div class="line number93 index92 alt2">
            93
           </div>
           <div class="line number94 index93 alt1">
            94
           </div>
           <div class="line number95 index94 alt2">
            95
           </div>
           <div class="line number96 index95 alt1">
            96
           </div>
           <div class="line number97 index96 alt2">
            97
           </div>
           <div class="line number98 index97 alt1">
            98
           </div>
           <div class="line number99 index98 alt2">
            99
           </div>
           <div class="line number100 index99 alt1">
            100
           </div>
           <div class="line number101 index100 alt2">
            101
           </div>
           <div class="line number102 index101 alt1">
            102
           </div>
           <div class="line number103 index102 alt2">
            103
           </div>
           <div class="line number104 index103 alt1">
            104
           </div>
           <div class="line number105 index104 alt2">
            105
           </div>
           <div class="line number106 index105 alt1">
            106
           </div>
           <div class="line number107 index106 alt2">
            107
           </div>
           <div class="line number108 index107 alt1">
            108
           </div>
           <div class="line number109 index108 alt2">
            109
           </div>
           <div class="line number110 index109 alt1">
            110
           </div>
           <div class="line number111 index110 alt2">
            111
           </div>
           <div class="line number112 index111 alt1">
            112
           </div>
           <div class="line number113 index112 alt2">
            113
           </div>
           <div class="line number114 index113 alt1">
            114
           </div>
           <div class="line number115 index114 alt2">
            115
           </div>
           <div class="line number116 index115 alt1">
            116
           </div>
           <div class="line number117 index116 alt2">
            117
           </div>
           <div class="line number118 index117 alt1">
            118
           </div>
           <div class="line number119 index118 alt2">
            119
           </div>
           <div class="line number120 index119 alt1">
            120
           </div>
           <div class="line number121 index120 alt2">
            121
           </div>
           <div class="line number122 index121 alt1">
            122
           </div>
           <div class="line number123 index122 alt2">
            123
           </div>
           <div class="line number124 index123 alt1">
            124
           </div>
           <div class="line number125 index124 alt2">
            125
           </div>
           <div class="line number126 index125 alt1">
            126
           </div>
           <div class="line number127 index126 alt2">
            127
           </div>
           <div class="line number128 index127 alt1">
            128
           </div>
           <div class="line number129 index128 alt2">
            129
           </div>
           <div class="line number130 index129 alt1">
            130
           </div>
           <div class="line number131 index130 alt2">
            131
           </div>
           <div class="line number132 index131 alt1">
            132
           </div>
           <div class="line number133 index132 alt2">
            133
           </div>
           <div class="line number134 index133 alt1">
            134
           </div>
           <div class="line number135 index134 alt2">
            135
           </div>
           <div class="line number136 index135 alt1">
            136
           </div>
           <div class="line number137 index136 alt2">
            137
           </div>
           <div class="line number138 index137 alt1">
            138
           </div>
           <div class="line number139 index138 alt2">
            139
           </div>
           <div class="line number140 index139 alt1">
            140
           </div>
           <div class="line number141 index140 alt2">
            141
           </div>
           <div class="line number142 index141 alt1">
            142
           </div>
           <div class="line number143 index142 alt2">
            143
           </div>
           <div class="line number144 index143 alt1">
            144
           </div>
           <div class="line number145 index144 alt2">
            145
           </div>
           <div class="line number146 index145 alt1">
            146
           </div>
           <div class="line number147 index146 alt2">
            147
           </div>
           <div class="line number148 index147 alt1">
            148
           </div>
           <div class="line number149 index148 alt2">
            149
           </div>
           <div class="line number150 index149 alt1">
            150
           </div>
           <div class="line number151 index150 alt2">
            151
           </div>
           <div class="line number152 index151 alt1">
            152
           </div>
           <div class="line number153 index152 alt2">
            153
           </div>
           <div class="line number154 index153 alt1">
            154
           </div>
           <div class="line number155 index154 alt2">
            155
           </div>
           <div class="line number156 index155 alt1">
            156
           </div>
           <div class="line number157 index156 alt2">
            157
           </div>
           <div class="line number158 index157 alt1">
            158
           </div>
           <div class="line number159 index158 alt2">
            159
           </div>
           <div class="line number160 index159 alt1">
            160
           </div>
           <div class="line number161 index160 alt2">
            161
           </div>
           <div class="line number162 index161 alt1">
            162
           </div>
           <div class="line number163 index162 alt2">
            163
           </div>
           <div class="line number164 index163 alt1">
            164
           </div>
           <div class="line number165 index164 alt2">
            165
           </div>
           <div class="line number166 index165 alt1">
            166
           </div>
           <div class="line number167 index166 alt2">
            167
           </div>
           <div class="line number168 index167 alt1">
            168
           </div>
           <div class="line number169 index168 alt2">
            169
           </div>
           <div class="line number170 index169 alt1">
            170
           </div>
           <div class="line number171 index170 alt2">
            171
           </div>
           <div class="line number172 index171 alt1">
            172
           </div>
           <div class="line number173 index172 alt2">
            173
           </div>
           <div class="line number174 index173 alt1">
            174
           </div>
           <div class="line number175 index174 alt2">
            175
           </div>
           <div class="line number176 index175 alt1">
            176
           </div>
           <div class="line number177 index176 alt2">
            177
           </div>
           <div class="line number178 index177 alt1">
            178
           </div>
           <div class="line number179 index178 alt2">
            179
           </div>
           <div class="line number180 index179 alt1">
            180
           </div>
           <div class="line number181 index180 alt2">
            181
           </div>
           <div class="line number182 index181 alt1">
            182
           </div>
           <div class="line number183 index182 alt2">
            183
           </div>
           <div class="line number184 index183 alt1">
            184
           </div>
           <div class="line number185 index184 alt2">
            185
           </div>
           <div class="line number186 index185 alt1">
            186
           </div>
           <div class="line number187 index186 alt2">
            187
           </div>
           <div class="line number188 index187 alt1">
            188
           </div>
           <div class="line number189 index188 alt2">
            189
           </div>
           <div class="line number190 index189 alt1">
            190
           </div>
           <div class="line number191 index190 alt2">
            191
           </div>
           <div class="line number192 index191 alt1">
            192
           </div>
           <div class="line number193 index192 alt2">
            193
           </div>
           <div class="line number194 index193 alt1">
            194
           </div>
           <div class="line number195 index194 alt2">
            195
           </div>
           <div class="line number196 index195 alt1">
            196
           </div>
           <div class="line number197 index196 alt2">
            197
           </div>
           <div class="line number198 index197 alt1">
            198
           </div>
           <div class="line number199 index198 alt2">
            199
           </div>
           <div class="line number200 index199 alt1">
            200
           </div>
           <div class="line number201 index200 alt2">
            201
           </div>
           <div class="line number202 index201 alt1">
            202
           </div>
           <div class="line number203 index202 alt2">
            203
           </div>
           <div class="line number204 index203 alt1">
            204
           </div>
           <div class="line number205 index204 alt2">
            205
           </div>
           <div class="line number206 index205 alt1">
            206
           </div>
           <div class="line number207 index206 alt2">
            207
           </div>
           <div class="line number208 index207 alt1">
            208
           </div>
           <div class="line number209 index208 alt2">
            209
           </div>
           <div class="line number210 index209 alt1">
            210
           </div>
           <div class="line number211 index210 alt2">
            211
           </div>
           <div class="line number212 index211 alt1">
            212
           </div>
           <div class="line number213 index212 alt2">
            213
           </div>
           <div class="line number214 index213 alt1">
            214
           </div>
           <div class="line number215 index214 alt2">
            215
           </div>
           <div class="line number216 index215 alt1">
            216
           </div>
           <div class="line number217 index216 alt2">
            217
           </div>
           <div class="line number218 index217 alt1">
            218
           </div>
           <div class="line number219 index218 alt2">
            219
           </div>
           <div class="line number220 index219 alt1">
            220
           </div>
           <div class="line number221 index220 alt2">
            221
           </div>
           <div class="line number222 index221 alt1">
            222
           </div>
           <div class="line number223 index222 alt2">
            223
           </div>
           <div class="line number224 index223 alt1">
            224
           </div>
           <div class="line number225 index224 alt2">
            225
           </div>
           <div class="line number226 index225 alt1">
            226
           </div>
           <div class="line number227 index226 alt2">
            227
           </div>
           <div class="line number228 index227 alt1">
            228
           </div>
           <div class="line number229 index228 alt2">
            229
           </div>
           <div class="line number230 index229 alt1">
            230
           </div>
           <div class="line number231 index230 alt2">
            231
           </div>
           <div class="line number232 index231 alt1">
            232
           </div>
           <div class="line number233 index232 alt2">
            233
           </div>
           <div class="line number234 index233 alt1">
            234
           </div>
           <div class="line number235 index234 alt2">
            235
           </div>
           <div class="line number236 index235 alt1">
            236
           </div>
           <div class="line number237 index236 alt2">
            237
           </div>
           <div class="line number238 index237 alt1">
            238
           </div>
           <div class="line number239 index238 alt2">
            239
           </div>
           <div class="line number240 index239 alt1">
            240
           </div>
           <div class="line number241 index240 alt2">
            241
           </div>
           <div class="line number242 index241 alt1">
            242
           </div>
           <div class="line number243 index242 alt2">
            243
           </div>
           <div class="line number244 index243 alt1">
            244
           </div>
           <div class="line number245 index244 alt2">
            245
           </div>
           <div class="line number246 index245 alt1">
            246
           </div>
           <div class="line number247 index246 alt2">
            247
           </div>
           <div class="line number248 index247 alt1">
            248
           </div>
           <div class="line number249 index248 alt2">
            249
           </div>
           <div class="line number250 index249 alt1">
            250
           </div>
           <div class="line number251 index250 alt2">
            251
           </div>
           <div class="line number252 index251 alt1">
            252
           </div>
           <div class="line number253 index252 alt2">
            253
           </div>
           <div class="line number254 index253 alt1">
            254
           </div>
           <div class="line number255 index254 alt2">
            255
           </div>
           <div class="line number256 index255 alt1">
            256
           </div>
           <div class="line number257 index256 alt2">
            257
           </div>
           <div class="line number258 index257 alt1">
            258
           </div>
           <div class="line number259 index258 alt2">
            259
           </div>
           <div class="line number260 index259 alt1">
            260
           </div>
           <div class="line number261 index260 alt2">
            261
           </div>
           <div class="line number262 index261 alt1">
            262
           </div>
           <div class="line number263 index262 alt2">
            263
           </div>
           <div class="line number264 index263 alt1">
            264
           </div>
           <div class="line number265 index264 alt2">
            265
           </div>
           <div class="line number266 index265 alt1">
            266
           </div>
           <div class="line number267 index266 alt2">
            267
           </div>
           <div class="line number268 index267 alt1">
            268
           </div>
           <div class="line number269 index268 alt2">
            269
           </div>
           <div class="line number270 index269 alt1">
            270
           </div></td>
          <td class="code">
           <div class="container">
            <div class="line number1 index0 alt2">
             <code class="php plain">&lt;?php </code>
            </div>
            <div class="line number2 index1 alt1">
             <code class="php keyword">namespace</code> 
             <code class="php plain">Component; </code>
            </div>
            <div class="line number3 index2 alt2">
             <code class="php spaces">&nbsp;</code>&nbsp;
            </div>
            <div class="line number4 index3 alt1">
             <code class="php plain">session_start(); </code>
            </div>
            <div class="line number5 index4 alt2">
             <code class="php plain">define(</code>
             <code class="php string">'APPID'</code>
             <code class="php plain">,</code>
             <code class="php string">'XXXX'</code>
             <code class="php plain">);&nbsp;&nbsp; </code>
             <code class="php comments">//appid </code>
            </div>
            <div class="line number6 index5 alt1">
             <code class="php plain">define(</code>
             <code class="php string">'APPKEY'</code>
             <code class="php plain">,</code>
             <code class="php string">'XXXX'</code>
             <code class="php plain">);&nbsp; </code>
             <code class="php comments">//appkey </code>
            </div>
            <div class="line number7 index6 alt2">
             <code class="php plain">define(</code>
             <code class="php string">'CALLBACK'</code>
             <code class="php plain">,</code>
             <code class="php string">'XXXX'</code>
             <code class="php plain">);&nbsp; </code>
             <code class="php comments">//回调地址 </code>
            </div>
            <div class="line number8 index7 alt1">
             <code class="php plain">define(</code>
             <code class="php string">'SCOPE'</code>
             <code class="php plain">,</code>
             <code class="php string">'get_user_info,list_album,add_album,upload_pic,add_topic,add_weibo'</code>
             <code class="php plain">);&nbsp; </code>
             <code class="php comments">//授权接口列表 </code>
            </div>
            <div class="line number9 index8 alt2">
             <code class="php keyword">class</code> 
             <code class="php plain">QQ_LoginAction { </code>
            </div>
            <div class="line number10 index9 alt1">
             <code class="php spaces">&nbsp;</code>
             <code class="php keyword">const</code> 
             <code class="php plain">GET_AUTH_CODE_URL = </code>
             <code class="php string">&quot;<a href="https://graph.qq.com/oauth2.0/authorize">https://graph.qq.com/oauth2.0/authorize</a>&quot;</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number11 index10 alt2">
             <code class="php spaces">&nbsp;</code>
             <code class="php keyword">const</code> 
             <code class="php plain">GET_ACCESS_TOKEN_URL = </code>
             <code class="php string">&quot;<a href="https://graph.qq.com/oauth2.0/token">https://graph.qq.com/oauth2.0/token</a>&quot;</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number12 index11 alt1">
             <code class="php spaces">&nbsp;</code>
             <code class="php keyword">const</code> 
             <code class="php plain">GET_OPENID_URL = </code>
             <code class="php string">&quot;<a href="https://graph.qq.com/oauth2.0/me">https://graph.qq.com/oauth2.0/me</a>&quot;</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number13 index12 alt2">
             <code class="php spaces">&nbsp;</code>
             <code class="php keyword">private</code> 
             <code class="php variable">$APIMap</code> 
             <code class="php plain">= </code>
             <code class="php keyword">array</code>
             <code class="php plain">( </code>
            </div>
            <div class="line number14 index13 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php string">&quot;get_user_info&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php keyword">array</code>
             <code class="php plain">(&nbsp;&nbsp; </code>
             <code class="php comments">//获取用户资料 </code>
            </div>
            <div class="line number15 index14 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;<a href="https://graph.qq.com/user/get_user_info">https://graph.qq.com/user/get_user_info</a>&quot;</code>
             <code class="php plain">, </code>
            </div>
            <div class="line number16 index15 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">array</code>
             <code class="php plain">(</code>
             <code class="php string">&quot;format&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php string">&quot;json&quot;</code>
             <code class="php plain">), </code>
            </div>
            <div class="line number17 index16 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">), </code>
            </div>
            <div class="line number18 index17 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php string">&quot;add_t&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php keyword">array</code>
             <code class="php plain">(&nbsp;&nbsp;&nbsp; </code>
             <code class="php comments">//发布一条普通微博 </code>
            </div>
            <div class="line number19 index18 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;<a href="https://graph.qq.com/t/add_t">https://graph.qq.com/t/add_t</a>&quot;</code>
             <code class="php plain">, </code>
            </div>
            <div class="line number20 index19 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">array</code>
             <code class="php plain">(</code>
             <code class="php string">&quot;format&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php string">&quot;json&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;content&quot;</code>
             <code class="php plain">,</code>
             <code class="php string">&quot;#clientip&quot;</code>
             <code class="php plain">,</code>
             <code class="php string">&quot;#longitude&quot;</code>
             <code class="php plain">,</code>
             <code class="php string">&quot;#latitude&quot;</code>
             <code class="php plain">,</code>
             <code class="php string">&quot;#compatibleflag&quot;</code>
             <code class="php plain">), </code>
            </div>
            <div class="line number21 index20 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;POST&quot;</code>
            </div>
            <div class="line number22 index21 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">), </code>
            </div>
            <div class="line number23 index22 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php string">&quot;add_pic_t&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php keyword">array</code>
             <code class="php plain">(&nbsp;&nbsp;&nbsp; </code>
             <code class="php comments">//发布一条图片微博 </code>
            </div>
            <div class="line number24 index23 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;<a href="https://graph.qq.com/t/add_pic_t">https://graph.qq.com/t/add_pic_t</a>&quot;</code>
             <code class="php plain">, </code>
            </div>
            <div class="line number25 index24 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">array</code>
             <code class="php plain">(</code>
             <code class="php string">&quot;content&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;pic&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;format&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php string">&quot;json&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;#clientip&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;#longitude&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;#latitude&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;#syncflag&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;#compatiblefalg&quot;</code>
             <code class="php plain">), </code>
            </div>
            <div class="line number26 index25 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;POST&quot;</code>
            </div>
            <div class="line number27 index26 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">), </code>
            </div>
            <div class="line number28 index27 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php string">&quot;del_t&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php keyword">array</code>
             <code class="php plain">(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code>
             <code class="php comments">//删除一条微博 </code>
            </div>
            <div class="line number29 index28 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;<a href="https://graph.qq.com/t/del_t">https://graph.qq.com/t/del_t</a>&quot;</code>
             <code class="php plain">, </code>
            </div>
            <div class="line number30 index29 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">array</code>
             <code class="php plain">(</code>
             <code class="php string">&quot;id&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;format&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php string">&quot;json&quot;</code>
             <code class="php plain">), </code>
            </div>
            <div class="line number31 index30 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;POST&quot;</code>
            </div>
            <div class="line number32 index31 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">), </code>
            </div>
            <div class="line number33 index32 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php string">&quot;get_repost_list&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php keyword">array</code>
             <code class="php plain">(&nbsp;&nbsp;&nbsp; </code>
             <code class="php comments">//获取单条微博的转发或点评列表 </code>
            </div>
            <div class="line number34 index33 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;<a href="https://graph.qq.com/t/get_repost_list">https://graph.qq.com/t/get_repost_list</a>&quot;</code>
             <code class="php plain">, </code>
            </div>
            <div class="line number35 index34 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">array</code>
             <code class="php plain">(</code>
             <code class="php string">&quot;flag&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;rootid&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;pageflag&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;pagetime&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;reqnum&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;twitterid&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;format&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php string">&quot;json&quot;</code>
             <code class="php plain">) </code>
            </div>
            <div class="line number36 index35 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">), </code>
            </div>
            <div class="line number37 index36 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php string">&quot;get_info&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php keyword">array</code>
             <code class="php plain">(&nbsp;&nbsp;&nbsp;&nbsp; </code>
             <code class="php comments">//获取当前用户资料 </code>
            </div>
            <div class="line number38 index37 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;<a href="https://graph.qq.com/user/get_info">https://graph.qq.com/user/get_info</a>&quot;</code>
             <code class="php plain">, </code>
            </div>
            <div class="line number39 index38 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">array</code>
             <code class="php plain">(</code>
             <code class="php string">&quot;format&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php string">&quot;json&quot;</code>
             <code class="php plain">) </code>
            </div>
            <div class="line number40 index39 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">), </code>
            </div>
            <div class="line number41 index40 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php string">&quot;get_other_info&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php keyword">array</code>
             <code class="php plain">(&nbsp;&nbsp;&nbsp; </code>
             <code class="php comments">//获取其他用户资料 </code>
            </div>
            <div class="line number42 index41 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;<a href="https://graph.qq.com/user/get_other_info">https://graph.qq.com/user/get_other_info</a>&quot;</code>
             <code class="php plain">, </code>
            </div>
            <div class="line number43 index42 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">array</code>
             <code class="php plain">(</code>
             <code class="php string">&quot;format&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php string">&quot;json&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;#name-1&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;#fopenid-1&quot;</code>
             <code class="php plain">) </code>
            </div>
            <div class="line number44 index43 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">), </code>
            </div>
            <div class="line number45 index44 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php string">&quot;get_fanslist&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php keyword">array</code>
             <code class="php plain">( </code>
            </div>
            <div class="line number46 index45 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;<a href="https://graph.qq.com/relation/get_fanslist">https://graph.qq.com/relation/get_fanslist</a>&quot;</code>
             <code class="php plain">, //我的微博粉丝列表 </code>
            </div>
            <div class="line number47 index46 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">array</code>
             <code class="php plain">(</code>
             <code class="php string">&quot;format&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php string">&quot;json&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;reqnum&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;startindex&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;#mode&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;#install&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;#sex&quot;</code>
             <code class="php plain">) </code>
            </div>
            <div class="line number48 index47 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">), </code>
            </div>
            <div class="line number49 index48 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php string">&quot;get_idollist&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php keyword">array</code>
             <code class="php plain">( </code>
            </div>
            <div class="line number50 index49 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;<a href="https://graph.qq.com/relation/get_idollist">https://graph.qq.com/relation/get_idollist</a>&quot;</code>
             <code class="php plain">, //我的微博收听列表 </code>
            </div>
            <div class="line number51 index50 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">array</code>
             <code class="php plain">(</code>
             <code class="php string">&quot;format&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php string">&quot;json&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;reqnum&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;startindex&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;#mode&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;#install&quot;</code>
             <code class="php plain">) </code>
            </div>
            <div class="line number52 index51 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">), </code>
            </div>
            <div class="line number53 index52 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php string">&quot;add_idol&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php keyword">array</code>
             <code class="php plain">( </code>
            </div>
            <div class="line number54 index53 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;<a href="https://graph.qq.com/relation/add_idol">https://graph.qq.com/relation/add_idol</a>&quot;</code>
             <code class="php plain">,&nbsp; //微博收听某用户 </code>
            </div>
            <div class="line number55 index54 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">array</code>
             <code class="php plain">(</code>
             <code class="php string">&quot;format&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php string">&quot;json&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;#name-1&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;#fopenids-1&quot;</code>
             <code class="php plain">), </code>
            </div>
            <div class="line number56 index55 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;POST&quot;</code>
            </div>
            <div class="line number57 index56 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">), </code>
            </div>
            <div class="line number58 index57 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php string">&quot;del_idol&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php keyword">array</code>
             <code class="php plain">(&nbsp;&nbsp; </code>
             <code class="php comments">//微博取消收听某用户 </code>
            </div>
            <div class="line number59 index58 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;<a href="https://graph.qq.com/relation/del_idol">https://graph.qq.com/relation/del_idol</a>&quot;</code>
             <code class="php plain">, </code>
            </div>
            <div class="line number60 index59 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">array</code>
             <code class="php plain">(</code>
             <code class="php string">&quot;format&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php string">&quot;json&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;#name-1&quot;</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;#fopenid-1&quot;</code>
             <code class="php plain">), </code>
            </div>
            <div class="line number61 index60 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;POST&quot;</code>
            </div>
            <div class="line number62 index61 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">) </code>
            </div>
            <div class="line number63 index62 alt2">
             <code class="php spaces">&nbsp;</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number64 index63 alt1">
             <code class="php spaces">&nbsp;</code>
             <code class="php keyword">private</code> 
             <code class="php variable">$keysArr</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number65 index64 alt2">
             <code class="php spaces">&nbsp;</code>
             <code class="php keyword">function</code> 
             <code class="php plain">__construct(){ </code>
            </div>
            <div class="line number66 index65 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(</code>
             <code class="php variable">$_SESSION</code>
             <code class="php plain">[</code>
             <code class="php string">&quot;openid&quot;</code>
             <code class="php plain">]){ </code>
            </div>
            <div class="line number67 index66 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;keysArr = </code>
             <code class="php keyword">array</code>
             <code class="php plain">( </code>
            </div>
            <div class="line number68 index67 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;oauth_consumer_key&quot;</code> 
             <code class="php plain">=&gt; APPID, </code>
            </div>
            <div class="line number69 index68 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;access_token&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php variable">$_SESSION</code>
             <code class="php plain">[</code>
             <code class="php string">'access_token'</code>
             <code class="php plain">], </code>
            </div>
            <div class="line number70 index69 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;openid&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php variable">$_SESSION</code>
             <code class="php plain">[</code>
             <code class="php string">&quot;openid&quot;</code>
             <code class="php plain">] </code>
            </div>
            <div class="line number71 index70 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number72 index71 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">}</code>
             <code class="php keyword">else</code>
             <code class="php plain">{ </code>
            </div>
            <div class="line number73 index72 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;keysArr = </code>
             <code class="php keyword">array</code>
             <code class="php plain">( </code>
            </div>
            <div class="line number74 index73 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;oauth_consumer_key&quot;</code> 
             <code class="php plain">=&gt; APPID </code>
            </div>
            <div class="line number75 index74 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number76 index75 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number77 index76 alt2">
             <code class="php spaces">&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number78 index77 alt1">
             <code class="php spaces">&nbsp;</code>
             <code class="php keyword">public</code> 
             <code class="php keyword">function</code> 
             <code class="php plain">qq_login(){ </code>
            </div>
            <div class="line number79 index78 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">//-------生成唯一随机串防CSRF攻击 </code>
            </div>
            <div class="line number80 index79 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$_SESSION</code>
             <code class="php plain">[</code>
             <code class="php string">'state'</code>
             <code class="php plain">] = md5(uniqid(rand(), TRUE)); </code>
            </div>
            <div class="line number81 index80 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$keysArr</code> 
             <code class="php plain">= </code>
             <code class="php keyword">array</code>
             <code class="php plain">( </code>
            </div>
            <div class="line number82 index81 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;response_type&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php string">&quot;code&quot;</code>
             <code class="php plain">, </code>
            </div>
            <div class="line number83 index82 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;client_id&quot;</code> 
             <code class="php plain">=&gt; APPID, </code>
            </div>
            <div class="line number84 index83 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;redirect_uri&quot;</code> 
             <code class="php plain">=&gt; CALLBACK, </code>
            </div>
            <div class="line number85 index84 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;state&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php variable">$_SESSION</code>
             <code class="php plain">[</code>
             <code class="php string">'state'</code>
             <code class="php plain">], </code>
            </div>
            <div class="line number86 index85 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;scope&quot;</code> 
             <code class="php plain">=&gt; SCOPE </code>
            </div>
            <div class="line number87 index86 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number88 index87 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$login_url</code> 
             <code class="php plain">= self::GET_AUTH_CODE_URL.</code>
             <code class="php string">'?'</code>
             <code class="php plain">.http_build_query(</code>
             <code class="php variable">$keysArr</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number89 index88 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">header(</code>
             <code class="php string">&quot;Location:$login_url&quot;</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number90 index89 alt1">
             <code class="php spaces">&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number91 index90 alt2">
             <code class="php spaces">&nbsp;</code>
             <code class="php keyword">public</code> 
             <code class="php keyword">function</code> 
             <code class="php plain">qq_callback(){ </code>
            </div>
            <div class="line number92 index91 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">//--------验证state防止CSRF攻击 </code>
            </div>
            <div class="line number93 index92 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(</code>
             <code class="php variable">$_GET</code>
             <code class="php plain">[</code>
             <code class="php string">'state'</code>
             <code class="php plain">] != </code>
             <code class="php variable">$_SESSION</code>
             <code class="php plain">[</code>
             <code class="php string">'state'</code>
             <code class="php plain">]){ </code>
            </div>
            <div class="line number94 index93 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">return</code> 
             <code class="php plain">false; </code>
            </div>
            <div class="line number95 index94 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number96 index95 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">//-------请求参数列表 </code>
            </div>
            <div class="line number97 index96 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$keysArr</code> 
             <code class="php plain">= </code>
             <code class="php keyword">array</code>
             <code class="php plain">( </code>
            </div>
            <div class="line number98 index97 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;grant_type&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php string">&quot;authorization_code&quot;</code>
             <code class="php plain">, </code>
            </div>
            <div class="line number99 index98 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;client_id&quot;</code> 
             <code class="php plain">=&gt; APPID, </code>
            </div>
            <div class="line number100 index99 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;redirect_uri&quot;</code> 
             <code class="php plain">=&gt; CALLBACK, </code>
            </div>
            <div class="line number101 index100 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;client_secret&quot;</code> 
             <code class="php plain">=&gt; APPKEY, </code>
            </div>
            <div class="line number102 index101 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;code&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php variable">$_GET</code>
             <code class="php plain">[</code>
             <code class="php string">'code'</code>
             <code class="php plain">] </code>
            </div>
            <div class="line number103 index102 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number104 index103 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">//------构造请求access_token的url </code>
            </div>
            <div class="line number105 index104 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$token_url</code> 
             <code class="php plain">= self::GET_ACCESS_TOKEN_URL.</code>
             <code class="php string">'?'</code>
             <code class="php plain">.http_build_query(</code>
             <code class="php variable">$keysArr</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number106 index105 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$response</code> 
             <code class="php plain">= </code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;get_contents(</code>
             <code class="php variable">$token_url</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number107 index106 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(</code>
             <code class="php functions">strpos</code>
             <code class="php plain">(</code>
             <code class="php variable">$response</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;callback&quot;</code>
             <code class="php plain">) !== false){ </code>
            </div>
            <div class="line number108 index107 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$lpos</code> 
             <code class="php plain">= </code>
             <code class="php functions">strpos</code>
             <code class="php plain">(</code>
             <code class="php variable">$response</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;(&quot;</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number109 index108 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$rpos</code> 
             <code class="php plain">= </code>
             <code class="php functions">strrpos</code>
             <code class="php plain">(</code>
             <code class="php variable">$response</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;)&quot;</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number110 index109 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$response</code> 
             <code class="php plain">= </code>
             <code class="php functions">substr</code>
             <code class="php plain">(</code>
             <code class="php variable">$response</code>
             <code class="php plain">, </code>
             <code class="php variable">$lpos</code> 
             <code class="php plain">+ 1, </code>
             <code class="php variable">$rpos</code> 
             <code class="php plain">- </code>
             <code class="php variable">$lpos</code> 
             <code class="php plain">-1); </code>
            </div>
            <div class="line number111 index110 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$msg</code> 
             <code class="php plain">= json_decode(</code>
             <code class="php variable">$response</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number112 index111 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(isset(</code>
             <code class="php variable">$msg</code>
             <code class="php plain">-&gt;error)){ </code>
            </div>
            <div class="line number113 index112 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;showError(</code>
             <code class="php variable">$msg</code>
             <code class="php plain">-&gt;error, </code>
             <code class="php variable">$msg</code>
             <code class="php plain">-&gt;error_description); </code>
            </div>
            <div class="line number114 index113 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number115 index114 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number116 index115 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$params</code> 
             <code class="php plain">= </code>
             <code class="php keyword">array</code>
             <code class="php plain">(); </code>
            </div>
            <div class="line number117 index116 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php functions">parse_str</code>
             <code class="php plain">(</code>
             <code class="php variable">$response</code>
             <code class="php plain">, </code>
             <code class="php variable">$params</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number118 index117 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$_SESSION</code>
             <code class="php plain">[</code>
             <code class="php string">&quot;access_token&quot;</code>
             <code class="php plain">]=</code>
             <code class="php variable">$params</code>
             <code class="php plain">[</code>
             <code class="php string">&quot;access_token&quot;</code>
             <code class="php plain">]; </code>
            </div>
            <div class="line number119 index118 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;keysArr[</code>
             <code class="php string">'access_token'</code>
             <code class="php plain">]=</code>
             <code class="php variable">$params</code>
             <code class="php plain">[</code>
             <code class="php string">'access_token'</code>
             <code class="php plain">]; </code>
            </div>
            <div class="line number120 index119 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php keyword">return</code> 
             <code class="php variable">$params</code>
             <code class="php plain">[</code>
             <code class="php string">&quot;access_token&quot;</code>
             <code class="php plain">]; </code>
            </div>
            <div class="line number121 index120 alt2">
             <code class="php spaces">&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number122 index121 alt1">
             <code class="php spaces">&nbsp;</code>&nbsp;
            </div>
            <div class="line number123 index122 alt2">
             <code class="php spaces">&nbsp;</code>
             <code class="php keyword">public</code> 
             <code class="php keyword">function</code> 
             <code class="php plain">get_contents(</code>
             <code class="php variable">$url</code>
             <code class="php plain">){ </code>
            </div>
            <div class="line number124 index123 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php keyword">if</code> 
             <code class="php plain">(</code>
             <code class="php functions">ini_get</code>
             <code class="php plain">(</code>
             <code class="php string">&quot;allow_url_fopen&quot;</code>
             <code class="php plain">) == </code>
             <code class="php string">&quot;1&quot;</code>
             <code class="php plain">) { </code>
            </div>
            <div class="line number125 index124 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$response</code> 
             <code class="php plain">= </code>
             <code class="php functions">file_get_contents</code>
             <code class="php plain">(</code>
             <code class="php variable">$url</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number126 index125 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">}</code>
             <code class="php keyword">else</code>
             <code class="php plain">{ </code>
            </div>
            <div class="line number127 index126 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$ch</code> 
             <code class="php plain">= curl_init(); </code>
            </div>
            <div class="line number128 index127 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">curl_setopt(</code>
             <code class="php variable">$ch</code>
             <code class="php plain">, CURLOPT_SSL_VERIFYPEER, FALSE); </code>
            </div>
            <div class="line number129 index128 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">curl_setopt(</code>
             <code class="php variable">$ch</code>
             <code class="php plain">, CURLOPT_RETURNTRANSFER, TRUE); </code>
            </div>
            <div class="line number130 index129 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">curl_setopt(</code>
             <code class="php variable">$ch</code>
             <code class="php plain">, CURLOPT_URL, </code>
             <code class="php variable">$url</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number131 index130 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$response</code> 
             <code class="php plain">= curl_exec(</code>
             <code class="php variable">$ch</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number132 index131 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">curl_close(</code>
             <code class="php variable">$ch</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number133 index132 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number134 index133 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(</code>
             <code class="php functions">empty</code>
             <code class="php plain">(</code>
             <code class="php variable">$response</code>
             <code class="php plain">)){ </code>
            </div>
            <div class="line number135 index134 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">return</code> 
             <code class="php plain">false; </code>
            </div>
            <div class="line number136 index135 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number137 index136 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php keyword">return</code> 
             <code class="php variable">$response</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number138 index137 alt1">
             <code class="php spaces">&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number139 index138 alt2">
             <code class="php spaces">&nbsp;</code>
             <code class="php keyword">public</code> 
             <code class="php keyword">function</code> 
             <code class="php plain">get_openid(){ </code>
            </div>
            <div class="line number140 index139 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">//-------请求参数列表 </code>
            </div>
            <div class="line number141 index140 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$keysArr</code> 
             <code class="php plain">= </code>
             <code class="php keyword">array</code>
             <code class="php plain">( </code>
            </div>
            <div class="line number142 index141 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php string">&quot;access_token&quot;</code> 
             <code class="php plain">=&gt; </code>
             <code class="php variable">$_SESSION</code>
             <code class="php plain">[</code>
             <code class="php string">&quot;access_token&quot;</code>
             <code class="php plain">] </code>
            </div>
            <div class="line number143 index142 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number144 index143 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$graph_url</code> 
             <code class="php plain">= self::GET_OPENID_URL.</code>
             <code class="php string">'?'</code>
             <code class="php plain">.http_build_query(</code>
             <code class="php variable">$keysArr</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number145 index144 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$response</code> 
             <code class="php plain">= </code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;get_contents(</code>
             <code class="php variable">$graph_url</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number146 index145 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">//--------检测错误是否发生 </code>
            </div>
            <div class="line number147 index146 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(</code>
             <code class="php functions">strpos</code>
             <code class="php plain">(</code>
             <code class="php variable">$response</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;callback&quot;</code>
             <code class="php plain">) !== false){ </code>
            </div>
            <div class="line number148 index147 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$lpos</code> 
             <code class="php plain">= </code>
             <code class="php functions">strpos</code>
             <code class="php plain">(</code>
             <code class="php variable">$response</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;(&quot;</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number149 index148 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$rpos</code> 
             <code class="php plain">= </code>
             <code class="php functions">strrpos</code>
             <code class="php plain">(</code>
             <code class="php variable">$response</code>
             <code class="php plain">, </code>
             <code class="php string">&quot;)&quot;</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number150 index149 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$response</code> 
             <code class="php plain">= </code>
             <code class="php functions">substr</code>
             <code class="php plain">(</code>
             <code class="php variable">$response</code>
             <code class="php plain">, </code>
             <code class="php variable">$lpos</code> 
             <code class="php plain">+ 1, </code>
             <code class="php variable">$rpos</code> 
             <code class="php plain">- </code>
             <code class="php variable">$lpos</code> 
             <code class="php plain">-1); </code>
            </div>
            <div class="line number151 index150 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number152 index151 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$user</code> 
             <code class="php plain">= json_decode(</code>
             <code class="php variable">$response</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number153 index152 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(isset(</code>
             <code class="php variable">$user</code>
             <code class="php plain">-&gt;error)){ </code>
            </div>
            <div class="line number154 index153 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;showError(</code>
             <code class="php variable">$user</code>
             <code class="php plain">-&gt;error, </code>
             <code class="php variable">$user</code>
             <code class="php plain">-&gt;error_description); </code>
            </div>
            <div class="line number155 index154 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number156 index155 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">//------记录openid </code>
            </div>
            <div class="line number157 index156 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$_SESSION</code>
             <code class="php plain">[</code>
             <code class="php string">'openid'</code>
             <code class="php plain">]=</code>
             <code class="php variable">$user</code>
             <code class="php plain">-&gt;openid; </code>
            </div>
            <div class="line number158 index157 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;keysArr[</code>
             <code class="php string">'openid'</code>
             <code class="php plain">]=</code>
             <code class="php variable">$user</code>
             <code class="php plain">-&gt;openid; </code>
            </div>
            <div class="line number159 index158 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php keyword">return</code> 
             <code class="php variable">$user</code>
             <code class="php plain">-&gt;openid; </code>
            </div>
            <div class="line number160 index159 alt1">
             <code class="php spaces">&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number161 index160 alt2">
             <code class="php spaces">&nbsp;</code>&nbsp;
            </div>
            <div class="line number162 index161 alt1">
             <code class="php spaces">&nbsp;</code>
             <code class="php comments">/** </code>
            </div>
            <div class="line number163 index162 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">* showError </code>
            </div>
            <div class="line number164 index163 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">* 显示错误信息 </code>
            </div>
            <div class="line number165 index164 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">* @param int $code 错误代码 </code>
            </div>
            <div class="line number166 index165 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">* @param string $description 描述信息（可选） </code>
            </div>
            <div class="line number167 index166 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">*/</code>
            </div>
            <div class="line number168 index167 alt1">
             <code class="php spaces">&nbsp;</code>
             <code class="php keyword">public</code> 
             <code class="php keyword">function</code> 
             <code class="php plain">showError(</code>
             <code class="php variable">$code</code>
             <code class="php plain">, </code>
             <code class="php variable">$description</code> 
             <code class="php plain">= </code>
             <code class="php string">'$'</code>
             <code class="php plain">){ </code>
            </div>
            <div class="line number169 index168 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php functions">echo</code> 
             <code class="php string">&quot;&lt;meta charset=\&quot;UTF-8\&quot;&gt;&quot;</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number170 index169 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php functions">echo</code> 
             <code class="php string">&quot;&lt;h3&gt;error:&lt;/h3&gt;$code&quot;</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number171 index170 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php functions">echo</code> 
             <code class="php string">&quot;&lt;h3&gt;msg :&lt;/h3&gt;$description&quot;</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number172 index171 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php functions">exit</code>
             <code class="php plain">(); </code>
            </div>
            <div class="line number173 index172 alt2">
             <code class="php spaces">&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number174 index173 alt1">
             <code class="php spaces">&nbsp;</code>&nbsp;
            </div>
            <div class="line number175 index174 alt2">
             <code class="php spaces">&nbsp;</code>
             <code class="php comments">/** </code>
            </div>
            <div class="line number176 index175 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">* _call </code>
            </div>
            <div class="line number177 index176 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">* 魔术方法，做api调用转发 </code>
            </div>
            <div class="line number178 index177 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">* @param string $name 调用的方法名称 </code>
            </div>
            <div class="line number179 index178 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">* @param array $arg&nbsp; 参数列表数组 </code>
            </div>
            <div class="line number180 index179 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">* @since 5.0 </code>
            </div>
            <div class="line number181 index180 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">* @return array&nbsp;&nbsp; 返加调用结果数组 </code>
            </div>
            <div class="line number182 index181 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">*/</code>
            </div>
            <div class="line number183 index182 alt2">
             <code class="php spaces">&nbsp;</code>
             <code class="php keyword">public</code> 
             <code class="php keyword">function</code> 
             <code class="php plain">__call(</code>
             <code class="php variable">$name</code>
             <code class="php plain">,</code>
             <code class="php variable">$arg</code>
             <code class="php plain">){ </code>
            </div>
            <div class="line number184 index183 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">//如果APIMap不存在相应的api </code>
            </div>
            <div class="line number185 index184 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(</code>
             <code class="php functions">empty</code>
             <code class="php plain">(</code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;APIMap[</code>
             <code class="php variable">$name</code>
             <code class="php plain">])){ </code>
            </div>
            <div class="line number186 index185 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;showError(</code>
             <code class="php string">&quot;api调用名称错误&quot;</code>
             <code class="php plain">,</code>
             <code class="php string">&quot;不存在的API: &lt;span style='color:red;'&gt;$name&lt;/span&gt;&quot;</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number187 index186 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number188 index187 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">//从APIMap获取api相应参数 </code>
            </div>
            <div class="line number189 index188 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$baseUrl</code> 
             <code class="php plain">= </code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;APIMap[</code>
             <code class="php variable">$name</code>
             <code class="php plain">][0]; </code>
            </div>
            <div class="line number190 index189 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$argsList</code> 
             <code class="php plain">= </code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;APIMap[</code>
             <code class="php variable">$name</code>
             <code class="php plain">][1]; </code>
            </div>
            <div class="line number191 index190 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$method</code> 
             <code class="php plain">= isset(</code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;APIMap[</code>
             <code class="php variable">$name</code>
             <code class="php plain">][2]) ? </code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;APIMap[</code>
             <code class="php variable">$name</code>
             <code class="php plain">][2] : </code>
             <code class="php string">&quot;GET&quot;</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number192 index191 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(</code>
             <code class="php functions">empty</code>
             <code class="php plain">(</code>
             <code class="php variable">$arg</code>
             <code class="php plain">)){ </code>
            </div>
            <div class="line number193 index192 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$arg</code>
             <code class="php plain">[0] = null; </code>
            </div>
            <div class="line number194 index193 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number195 index194 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$responseArr</code> 
             <code class="php plain">= json_decode(</code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;_applyAPI(</code>
             <code class="php variable">$arg</code>
             <code class="php plain">[0], </code>
             <code class="php variable">$argsList</code>
             <code class="php plain">, </code>
             <code class="php variable">$baseUrl</code>
             <code class="php plain">, </code>
             <code class="php variable">$method</code>
             <code class="php plain">),true); </code>
            </div>
            <div class="line number196 index195 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">//检查返回ret判断api是否成功调用 </code>
            </div>
            <div class="line number197 index196 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(</code>
             <code class="php variable">$responseArr</code>
             <code class="php plain">[</code>
             <code class="php string">'ret'</code>
             <code class="php plain">] == 0){ </code>
            </div>
            <div class="line number198 index197 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">return</code> 
             <code class="php variable">$responseArr</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number199 index198 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">}</code>
             <code class="php keyword">else</code>
             <code class="php plain">{ </code>
            </div>
            <div class="line number200 index199 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;showError(</code>
             <code class="php variable">$responseArr</code>
             <code class="php plain">[</code>
             <code class="php string">'ret'</code>
             <code class="php plain">], </code>
             <code class="php variable">$responseArr</code>
             <code class="php plain">[</code>
             <code class="php string">'msg'</code>
             <code class="php plain">]); </code>
            </div>
            <div class="line number201 index200 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number202 index201 alt1">
             <code class="php spaces">&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number203 index202 alt2">
             <code class="php spaces">&nbsp;</code>&nbsp;
            </div>
            <div class="line number204 index203 alt1">
             <code class="php spaces">&nbsp;</code>
             <code class="php comments">//调用相应api </code>
            </div>
            <div class="line number205 index204 alt2">
             <code class="php spaces">&nbsp;</code>
             <code class="php keyword">private</code> 
             <code class="php keyword">function</code> 
             <code class="php plain">_applyAPI(</code>
             <code class="php variable">$arr</code>
             <code class="php plain">, </code>
             <code class="php variable">$argsList</code>
             <code class="php plain">, </code>
             <code class="php variable">$baseUrl</code>
             <code class="php plain">, </code>
             <code class="php variable">$method</code>
             <code class="php plain">){ </code>
            </div>
            <div class="line number206 index205 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$pre</code> 
             <code class="php plain">= </code>
             <code class="php string">&quot;#&quot;</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number207 index206 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$keysArr</code> 
             <code class="php plain">= </code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;keysArr; </code>
            </div>
            <div class="line number208 index207 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$optionArgList</code> 
             <code class="php plain">= </code>
             <code class="php keyword">array</code>
             <code class="php plain">();</code>
             <code class="php comments">//一些多项选填参数必选一的情形 </code>
            </div>
            <div class="line number209 index208 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php keyword">foreach</code>
             <code class="php plain">(</code>
             <code class="php variable">$argsList</code> 
             <code class="php keyword">as</code> 
             <code class="php variable">$key</code> 
             <code class="php plain">=&gt; </code>
             <code class="php variable">$val</code>
             <code class="php plain">){ </code>
            </div>
            <div class="line number210 index209 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$tmpKey</code> 
             <code class="php plain">= </code>
             <code class="php variable">$key</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number211 index210 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$tmpVal</code> 
             <code class="php plain">= </code>
             <code class="php variable">$val</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number212 index211 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(!</code>
             <code class="php functions">is_string</code>
             <code class="php plain">(</code>
             <code class="php variable">$key</code>
             <code class="php plain">)){ </code>
            </div>
            <div class="line number213 index212 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$tmpKey</code> 
             <code class="php plain">= </code>
             <code class="php variable">$val</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number214 index213 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(</code>
             <code class="php functions">strpos</code>
             <code class="php plain">(</code>
             <code class="php variable">$val</code>
             <code class="php plain">,</code>
             <code class="php variable">$pre</code>
             <code class="php plain">) === 0){ </code>
            </div>
            <div class="line number215 index214 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$tmpVal</code> 
             <code class="php plain">= </code>
             <code class="php variable">$pre</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number216 index215 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$tmpKey</code> 
             <code class="php plain">= </code>
             <code class="php functions">substr</code>
             <code class="php plain">(</code>
             <code class="php variable">$tmpKey</code>
             <code class="php plain">,1); </code>
            </div>
            <div class="line number217 index216 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(preg_match(</code>
             <code class="php string">&quot;/-(\d$)/&quot;</code>
             <code class="php plain">, </code>
             <code class="php variable">$tmpKey</code>
             <code class="php plain">, </code>
             <code class="php variable">$res</code>
             <code class="php plain">)){ </code>
            </div>
            <div class="line number218 index217 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$tmpKey</code> 
             <code class="php plain">= </code>
             <code class="php functions">str_replace</code>
             <code class="php plain">(</code>
             <code class="php variable">$res</code>
             <code class="php plain">[0], </code>
             <code class="php string">&quot;&quot;</code>
             <code class="php plain">, </code>
             <code class="php variable">$tmpKey</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number219 index218 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$optionArgList</code>
             <code class="php plain">[]= </code>
             <code class="php variable">$tmpKey</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number220 index219 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number221 index220 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">}</code>
             <code class="php keyword">else</code>
             <code class="php plain">{ </code>
            </div>
            <div class="line number222 index221 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$tmpVal</code> 
             <code class="php plain">= null; </code>
            </div>
            <div class="line number223 index222 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number224 index223 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number225 index224 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php comments">//-----如果没有设置相应的参数 </code>
            </div>
            <div class="line number226 index225 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(!isset(</code>
             <code class="php variable">$arr</code>
             <code class="php plain">[</code>
             <code class="php variable">$tmpKey</code>
             <code class="php plain">]) || </code>
             <code class="php variable">$arr</code>
             <code class="php plain">[</code>
             <code class="php variable">$tmpKey</code>
             <code class="php plain">] === </code>
             <code class="php string">&quot;&quot;</code>
             <code class="php plain">){ </code>
            </div>
            <div class="line number227 index226 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(</code>
             <code class="php variable">$tmpVal</code> 
             <code class="php plain">== </code>
             <code class="php variable">$pre</code>
             <code class="php plain">){ </code>
            </div>
            <div class="line number228 index227 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">continue</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number229 index228 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">}</code>
             <code class="php keyword">else</code> 
             <code class="php keyword">if</code>
             <code class="php plain">(</code>
             <code class="php variable">$tmpVal</code>
             <code class="php plain">){</code>
             <code class="php comments">//则使用默认的值 </code>
            </div>
            <div class="line number230 index229 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$arr</code>
             <code class="php plain">[</code>
             <code class="php variable">$tmpKey</code>
             <code class="php plain">] = </code>
             <code class="php variable">$tmpVal</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number231 index230 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">}</code>
             <code class="php keyword">else</code>
             <code class="php plain">{ </code>
            </div>
            <div class="line number232 index231 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;showError(</code>
             <code class="php string">&quot;api调用参数错误&quot;</code>
             <code class="php plain">,</code>
             <code class="php string">&quot;未传入参数$tmpKey&quot;</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number233 index232 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number234 index233 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number235 index234 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$keysArr</code>
             <code class="php plain">[</code>
             <code class="php variable">$tmpKey</code>
             <code class="php plain">] = </code>
             <code class="php variable">$arr</code>
             <code class="php plain">[</code>
             <code class="php variable">$tmpKey</code>
             <code class="php plain">]; </code>
            </div>
            <div class="line number236 index235 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number237 index236 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php comments">//检查选填参数必填一的情形 </code>
            </div>
            <div class="line number238 index237 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(</code>
             <code class="php functions">count</code>
             <code class="php plain">(</code>
             <code class="php variable">$optionArgList</code>
             <code class="php plain">)!=0){ </code>
            </div>
            <div class="line number239 index238 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$n</code> 
             <code class="php plain">= 0; </code>
            </div>
            <div class="line number240 index239 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">foreach</code>
             <code class="php plain">(</code>
             <code class="php variable">$optionArgList</code> 
             <code class="php keyword">as</code> 
             <code class="php variable">$val</code>
             <code class="php plain">){ </code>
            </div>
            <div class="line number241 index240 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(in_array(</code>
             <code class="php variable">$val</code>
             <code class="php plain">, </code>
             <code class="php functions">array_keys</code>
             <code class="php plain">(</code>
             <code class="php variable">$keysArr</code>
             <code class="php plain">))){ </code>
            </div>
            <div class="line number242 index241 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$n</code>
             <code class="php plain">++; </code>
            </div>
            <div class="line number243 index242 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number244 index243 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number245 index244 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(!</code>
             <code class="php variable">$n</code>
             <code class="php plain">){ </code>
            </div>
            <div class="line number246 index245 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$str</code> 
             <code class="php plain">= implode(</code>
             <code class="php string">&quot;,&quot;</code>
             <code class="php plain">,</code>
             <code class="php variable">$optionArgList</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number247 index246 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;showError(</code>
             <code class="php string">&quot;api调用参数错误&quot;</code>
             <code class="php plain">,</code>
             <code class="php variable">$str</code>
             <code class="php plain">.</code>
             <code class="php string">&quot;必填一个&quot;</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number248 index247 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number249 index248 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number250 index249 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(</code>
             <code class="php variable">$method</code> 
             <code class="php plain">== </code>
             <code class="php string">&quot;POST&quot;</code>
             <code class="php plain">){ </code>
            </div>
            <div class="line number251 index250 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$response</code> 
             <code class="php plain">= </code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;post(</code>
             <code class="php variable">$baseUrl</code>
             <code class="php plain">, </code>
             <code class="php variable">$keysArr</code>
             <code class="php plain">, 0); </code>
            </div>
            <div class="line number252 index251 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">}</code>
             <code class="php keyword">else</code> 
             <code class="php keyword">if</code>
             <code class="php plain">(</code>
             <code class="php variable">$method</code> 
             <code class="php plain">== </code>
             <code class="php string">&quot;GET&quot;</code>
             <code class="php plain">){ </code>
            </div>
            <div class="line number253 index252 alt2">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$baseUrl</code>
             <code class="php plain">=</code>
             <code class="php variable">$baseUrl</code>
             <code class="php plain">.</code>
             <code class="php string">'?'</code>
             <code class="php plain">.http_build_query(</code>
             <code class="php variable">$keysArr</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number254 index253 alt1">
             <code class="php spaces">&nbsp;&nbsp;&nbsp;</code>
             <code class="php variable">$response</code> 
             <code class="php plain">= </code>
             <code class="php variable">$this</code>
             <code class="php plain">-&gt;get_contents(</code>
             <code class="php variable">$baseUrl</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number255 index254 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number256 index255 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php keyword">return</code> 
             <code class="php variable">$response</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number257 index256 alt2">
             <code class="php spaces">&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number258 index257 alt1">
             <code class="php spaces">&nbsp;</code>&nbsp;
            </div>
            <div class="line number259 index258 alt2">
             <code class="php spaces">&nbsp;</code>
             <code class="php keyword">public</code> 
             <code class="php keyword">function</code> 
             <code class="php plain">post(</code>
             <code class="php variable">$url</code>
             <code class="php plain">, </code>
             <code class="php variable">$keysArr</code>
             <code class="php plain">, </code>
             <code class="php variable">$flag</code> 
             <code class="php plain">= 0){ </code>
            </div>
            <div class="line number260 index259 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$ch</code> 
             <code class="php plain">= curl_init(); </code>
            </div>
            <div class="line number261 index260 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php keyword">if</code>
             <code class="php plain">(! </code>
             <code class="php variable">$flag</code>
             <code class="php plain">) curl_setopt(</code>
             <code class="php variable">$ch</code>
             <code class="php plain">, CURLOPT_SSL_VERIFYPEER, FALSE); </code>
            </div>
            <div class="line number262 index261 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">curl_setopt(</code>
             <code class="php variable">$ch</code>
             <code class="php plain">, CURLOPT_RETURNTRANSFER, TRUE); </code>
            </div>
            <div class="line number263 index262 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">curl_setopt(</code>
             <code class="php variable">$ch</code>
             <code class="php plain">, CURLOPT_POST, TRUE); </code>
            </div>
            <div class="line number264 index263 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">curl_setopt(</code>
             <code class="php variable">$ch</code>
             <code class="php plain">, CURLOPT_POSTFIELDS, </code>
             <code class="php variable">$keysArr</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number265 index264 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">curl_setopt(</code>
             <code class="php variable">$ch</code>
             <code class="php plain">, CURLOPT_URL, </code>
             <code class="php variable">$url</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number266 index265 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php variable">$ret</code> 
             <code class="php plain">= curl_exec(</code>
             <code class="php variable">$ch</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number267 index266 alt2">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php plain">curl_close(</code>
             <code class="php variable">$ch</code>
             <code class="php plain">); </code>
            </div>
            <div class="line number268 index267 alt1">
             <code class="php spaces">&nbsp;&nbsp;</code>
             <code class="php keyword">return</code> 
             <code class="php variable">$ret</code>
             <code class="php plain">; </code>
            </div>
            <div class="line number269 index268 alt2">
             <code class="php spaces">&nbsp;</code>
             <code class="php plain">} </code>
            </div>
            <div class="line number270 index269 alt1">
             <code class="php plain">} </code>
            </div>
           </div></td>
         </tr>
        </tbody>
       </table>
      </div>
     </div> 
    </div> 
    <p><span style="color: #800000"><strong>方法三，</strong></span>面向对象 使用腾讯给的SDK<br /> 使用方法:腾讯SDK，API写的很详细，不做赘述<br /> 地址：http://wiki.connect.qq.com/%E7%BD%91%E7%AB%99%E6%8E%A5%E5%85%A5%E6%A6%82%E8%BF%B0</p> 
    <p>这样就实现了QQ快捷登录，其实很简单的，大家可以试一试。<br /> 还有什么不清楚的，可以看看官方介绍，更详细，</p> 
    <p><strong>Tips:</strong>如何在本地测试QQ快速登录<br /> 方法：修改HOST配置文件<br /> 1. 打开C:\Windows\System32\drivers\etc\host<br /> 2. 添加127.0.0.1&nbsp;&nbsp; &nbsp;www.test.com<br /> 然后操作就可以了。</p> 
    <p>以上就是本文的全部内容，希望对大家的学习有所帮助，也希望大家多多支持脚本之家。</p> 

    <div class="clearfix"> 
     <a href="http://t.cn/EvW2Wb8" target="_blank"><img src="//files.jb51.net/image/php_tb.png?0918" width="700" height="100" class="nohref" /></a> 
    </div> 
    <div class="jb51ewm">
     <div class="fl">
      <img src="//files.jb51.net/skin/2018/images/jb51ewm.png" />
     </div>
     <div class="fr">
      <p>微信公众号搜索 “ <span>脚本之家</span> ” ，选择关注</p>
      <p>程序猿的那些事、送书等活动等着你</p>
     </div>
    </div>
   </div>
   <!--endmain--> 
   <div class="tags clearfix"> 
    <i class="icon-tag"></i> 
    <ul class="meta-tags items"> 
     <li class="tag item"><a href="http://common.jb51.net/tag/PHP/1.htm" target="_blank" title="搜索关于PHP的文章" rel="nofollow">PHP</a></li> 
     <li class="tag item"><a href="http://common.jb51.net/tag/QQ/1.htm" target="_blank" title="搜索关于QQ的文章" rel="nofollow">QQ</a></li> 
     <li class="tag item"><a href="http://common.jb51.net/tag/%E7%99%BB%E5%BD%95/1.htm" target="_blank" title="搜索关于登录的文章" rel="nofollow">登录</a></li> 
    </ul> 
   </div> 
   <div class="lbd clearfix"> 
    <div id="_nktod5sx72a" style="">
     <div style="padding-top:0px;">
      <iframe width="700" frameborder="0" height="260" scrolling="no" src="//pos.baidu.com/s?hei=260&amp;wid=700&amp;di=u3196581&amp;ltu=https%3A%2F%2Fwww.jb51.net%2Farticle%2F93749.htm&amp;cfv=0&amp;psr=1920x1080&amp;ccd=24&amp;tcn=1537840472&amp;col=zh-CN&amp;cdo=-1&amp;ti=PHP%E5%AE%9E%E7%8E%B0QQ%E5%BF%AB%E9%80%9F%E7%99%BB%E5%BD%95%E7%9A%84%E6%96%B9%E6%B3%95_php%E5%AE%9E%E4%BE%8B_%E8%84%9A%E6%9C%AC%E4%B9%8B%E5%AE%B6&amp;dc=3&amp;tlm=1537840472&amp;tpr=1537840472452&amp;exps=111000&amp;cmi=4&amp;cpl=3&amp;ant=0&amp;drs=1&amp;dtm=HTML_POST&amp;ari=2&amp;dri=0&amp;cce=true&amp;cja=false&amp;ps=0x0&amp;par=1920x1040&amp;cec=GBK&amp;dis=0&amp;pis=-1x-1&amp;chi=2&amp;pcs=1903x889&amp;dai=3&amp;pss=1903x13276&amp;prot=2"></iframe>
      <abbr style="display:none;"></abbr>
     </div>
    </div>
    <script type="text/javascript" src="//jscode.jbzj.com/site/api/1s307x.js?lgypof=dip"></script> 
   </div> 
   <div id="shoucang"></div> 
   <div class="xgcomm clearfix"> 
    <h2>相关文章</h2> 
    <ul>
     <li class="lbd clearfix">
      <div style="">
       <iframe width="700" frameborder="0" height="120" scrolling="no" src="https://pos.baidu.com/s?hei=120&amp;wid=700&amp;di=u3183442&amp;ltu=https%3A%2F%2Fwww.jb51.net%2Farticle%2F93749.htm&amp;ari=2&amp;pss=1903x13536&amp;cja=false&amp;chi=2&amp;cce=true&amp;tcn=1537840473&amp;ti=PHP%E5%AE%9E%E7%8E%B0QQ%E5%BF%AB%E9%80%9F%E7%99%BB%E5%BD%95%E7%9A%84%E6%96%B9%E6%B3%95_php%E5%AE%9E%E4%BE%8B_%E8%84%9A%E6%9C%AC%E4%B9%8B%E5%AE%B6&amp;dai=4&amp;ant=0&amp;dri=0&amp;ccd=24&amp;pcs=1903x889&amp;pis=-1x-1&amp;psr=1920x1080&amp;col=zh-CN&amp;ps=0x0&amp;cec=GBK&amp;exps=111000&amp;cfv=0&amp;cdo=-1&amp;cmi=4&amp;dis=0&amp;dtm=HTML_POST&amp;dc=3&amp;cpl=3&amp;prot=2&amp;par=1920x1040&amp;drs=1&amp;tlm=1537840472&amp;tpr=1537840472452"></iframe>
      </div><script type="text/javascript" src="//jscode.jbzj.com/production/source/common/46pg.js?dyqhaquu=n"></script> </li>
     <li>
      <div class="item-inner">
       <a href="/article/47854.htm" title="php 创建以UNIX时间戳命名的文件夹(示例代码)" class="img-wrap" target="_blank"> <img alt="php 创建以UNIX时间戳命名的文件夹(示例代码)" src="//files.jb51.net/images/xgimg/bcimg0.png" /> </a>
       <div class="rbox">
        <div class="rbox-inner">
         <p><a class="link title" target="_blank" href="/article/47854.htm" title="php 创建以UNIX时间戳命名的文件夹(示例代码)">php 创建以UNIX时间戳命名的文件夹(示例代码)</a></p>
         <div class="item-info">
          <div class="js">
           这篇文章主要介绍了php创建以UNIX时间戳命名的文件夹(示例代码)。需要的朋友可以过来参考下，希望对大家有所帮助
          </div>
          <span class="lbtn" style="float:right"> 2014-03-03 </span>
         </div>
        </div>
       </div>
      </div></li> 
     <li>
      <div class="item-inner">
       <a href="/article/43141.htm" title="使用php计算排列组合的方法" class="img-wrap" target="_blank"> <img alt="使用php计算排列组合的方法" src="//files.jb51.net/images/xgimg/bcimg1.png" /> </a>
       <div class="rbox">
        <div class="rbox-inner">
         <p><a class="link title" target="_blank" href="/article/43141.htm" title="使用php计算排列组合的方法">使用php计算排列组合的方法</a></p>
         <div class="item-info">
          <div class="js">
           本文用PHP要解决的数学问题是算出C(a,1) * C(b, 1) * ... * C(n, 1)的组合情况，其中C(n, 1)代表从n个元素里任意取一个元素 
          </div>
          <span class="lbtn" style="float:right"> 2013-11-11 </span>
         </div>
        </div>
       </div>
      </div></li> 
     <li>
      <div class="item-inner">
       <a href="/article/115753.htm" title="ThinkPHP+EasyUI之ComboTree中的会计科目树形菜单实现方法" class="img-wrap" target="_blank"> <img alt="ThinkPHP+EasyUI之ComboTree中的会计科目树形菜单实现方法" src="//files.jb51.net/images/xgimg/bcimg2.png" /> </a>
       <div class="rbox">
        <div class="rbox-inner">
         <p><a class="link title" target="_blank" href="/article/115753.htm" title="ThinkPHP+EasyUI之ComboTree中的会计科目树形菜单实现方法">ThinkPHP+EasyUI之ComboTree中的会计科目树形菜单实现方法</a></p>
         <div class="item-info">
          <div class="js">
           下面小编就为大家带来一篇ThinkPHP+EasyUI之ComboTree中的会计科目树形菜单实现方法。小编觉得挺不错的，现在就分享给大家，也给大家做个参考。一起跟随小编过来看看吧
          </div>
          <span class="lbtn" style="float:right"> 2017-06-06 </span>
         </div>
        </div>
       </div>
      </div></li> 
     <li>
      <div class="item-inner">
       <a href="/article/42722.htm" title="6种php上传图片重命名的方法实例" class="img-wrap" target="_blank"> <img alt="6种php上传图片重命名的方法实例" src="//files.jb51.net/images/xgimg/bcimg3.png" /> </a>
       <div class="rbox">
        <div class="rbox-inner">
         <p><a class="link title" target="_blank" href="/article/42722.htm" title="6种php上传图片重命名的方法实例">6种php上传图片重命名的方法实例</a></p>
         <div class="item-info">
          <div class="js">
           本文提供了6种php上传图片重命名的方法并对6种方法做了比较，肯定有一种合适你用的。
          </div>
          <span class="lbtn" style="float:right"> 2013-11-11 </span>
         </div>
        </div>
       </div>
      </div></li> 
     <li>
      <div class="item-inner">
       <a href="/article/62458.htm" title="php实现兼容2038年后Unix时间戳转换函数" class="img-wrap" target="_blank"> <img alt="php实现兼容2038年后Unix时间戳转换函数" src="//files.jb51.net/images/xgimg/bcimg4.png" /> </a>
       <div class="rbox">
        <div class="rbox-inner">
         <p><a class="link title" target="_blank" href="/article/62458.htm" title="php实现兼容2038年后Unix时间戳转换函数">php实现兼容2038年后Unix时间戳转换函数</a></p>
         <div class="item-info">
          <div class="js">
           这篇文章主要介绍了php实现兼容2038年后Unix时间戳转换函数，使用方法和就的函数一样，非常实用，推荐给大家，希望大家能够喜欢。
          </div>
          <span class="lbtn" style="float:right"> 2015-03-03 </span>
         </div>
        </div>
       </div>
      </div></li> 
     <li>
      <div class="item-inner">
       <a href="/article/77680.htm" title="PHP图像裁剪缩略裁切类源码及使用方法" class="img-wrap" target="_blank"> <img alt="PHP图像裁剪缩略裁切类源码及使用方法" src="//files.jb51.net/images/xgimg/bcimg5.png" /> </a>
       <div class="rbox">
        <div class="rbox-inner">
         <p><a class="link title" target="_blank" href="/article/77680.htm" title="PHP图像裁剪缩略裁切类源码及使用方法">PHP图像裁剪缩略裁切类源码及使用方法</a></p>
         <div class="item-info">
          <div class="js">
           这篇文章主要介绍了PHP图像裁剪缩略裁切类源码及使用方法的相关资料,需要的朋友可以参考下
          </div>
          <span class="lbtn" style="float:right"> 2016-01-01 </span>
         </div>
        </div>
       </div>
      </div></li> 
     <li>
      <div class="item-inner">
       <a href="/article/68972.htm" title="帝国CMS留言板回复后发送EMAIL通知客户" class="img-wrap" target="_blank"> <img alt="帝国CMS留言板回复后发送EMAIL通知客户" src="//files.jb51.net/images/xgimg/bcimg6.png" /> </a>
       <div class="rbox">
        <div class="rbox-inner">
         <p><a class="link title" target="_blank" href="/article/68972.htm" title="帝国CMS留言板回复后发送EMAIL通知客户">帝国CMS留言板回复后发送EMAIL通知客户</a></p>
         <div class="item-info">
          <div class="js">
           这篇文章主要介绍了帝国CMS留言板回复后发送EMAIL通知客户的方法和具体修改示例，有需要的小伙伴可以参考下。
          </div>
          <span class="lbtn" style="float:right"> 2015-07-07 </span>
         </div>
        </div>
       </div>
      </div></li> 
     <li>
      <div class="item-inner">
       <a href="/article/141714.htm" title="thinkPHP框架实现的无限回复评论功能示例" class="img-wrap" target="_blank"> <img alt="thinkPHP框架实现的无限回复评论功能示例" src="//files.jb51.net/images/xgimg/bcimg7.png" /> </a>
       <div class="rbox">
        <div class="rbox-inner">
         <p><a class="link title" target="_blank" href="/article/141714.htm" title="thinkPHP框架实现的无限回复评论功能示例">thinkPHP框架实现的无限回复评论功能示例</a></p>
         <div class="item-info">
          <div class="js">
           这篇文章主要介绍了thinkPHP框架实现的无限回复评论功能,结合实例形式简单分析了thinkPHP实现无限回复的相关控制器、视图操作技巧,需要的朋友可以参考下
          </div>
          <span class="lbtn" style="float:right"> 2018-06-06 </span>
         </div>
        </div>
       </div>
      </div></li> 
     <li>
      <div class="item-inner">
       <a href="/article/133325.htm" title="php nginx 实时输出的简单实现方法" class="img-wrap" target="_blank"> <img alt="php nginx 实时输出的简单实现方法" src="//files.jb51.net/images/xgimg/bcimg8.png" /> </a>
       <div class="rbox">
        <div class="rbox-inner">
         <p><a class="link title" target="_blank" href="/article/133325.htm" title="php nginx 实时输出的简单实现方法">php nginx 实时输出的简单实现方法</a></p>
         <div class="item-info">
          <div class="js">
           本文通过实例代码给大家介绍了php nginx 实时输出的简单实现方法，非常不错，具有参考借鉴价值，需要的朋友参考下吧
          </div>
          <span class="lbtn" style="float:right"> 2018-01-01 </span>
         </div>
        </div>
       </div>
      </div></li> 
     <li>
      <div class="item-inner">
       <a href="/article/53928.htm" title="zend framework框架中url大小写问题解决方法" class="img-wrap" target="_blank"> <img alt="zend framework框架中url大小写问题解决方法" src="//files.jb51.net/images/xgimg/bcimg9.png" /> </a>
       <div class="rbox">
        <div class="rbox-inner">
         <p><a class="link title" target="_blank" href="/article/53928.htm" title="zend framework框架中url大小写问题解决方法">zend framework框架中url大小写问题解决方法</a></p>
         <div class="item-info">
          <div class="js">
           这篇文章主要介绍了zend framework框架中url大小写问题解决方法,包括action控制器和请求URL的大小写,需要的朋友可以参考下
          </div>
          <span class="lbtn" style="float:right"> 2014-08-08 </span>
         </div>
        </div>
       </div>
      </div></li> 
    </ul> 
   </div> 

  </div>